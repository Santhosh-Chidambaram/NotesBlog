{% extends "notes/base.html" %}
{% load crispy_forms_tags %}


{% block nav %}
{% if user.is_authenticated %}
<ul class="navbar-nav">
    <li class="nav-item active">
        <a class="nav-link" href="{% url 'add_notes' %}" style="color: rgb(20, 220, 193);"><i class="fa fa-plus" aria-hidden="true" ></i>Add Post</a>
        </li>
    <li class="nav-item ">
        <a type="button" class="nav-link" href="{% url 'notification' %}" style="color: #fafafa;">
            <i class="fa fa-bell"></i> Notifications <span class="badge badge-danger" style="color: rgb(255, 255, 255);">{{ user.to_user_set.count }}</span>
          </a>
    </li>
    
    <li class="nav-item active">
        <a class="nav-link" href="{% url 'profile' user.pk %}" style="color: rgb(20, 213, 220);"><img src="{{ user.profile.profile_pic.url }}" alt="{{ user.profile.profile_pic.url }}" width="35" height="35" class="rounded-circle"> {{user.username}}</a>
        </li>
    <li class="nav-item active">
    <a class="nav-link" href="{% url 'user_logout' %}" style="color: rgb(20, 220, 63);"><i class="fa fa-sign-out" aria-hidden="true" ></i>Logout</a>
    </li>
</ul>

{% endif %}
{% endblock %}
{% block content %}
{% if re_user %}
<section style="margin-top: 5rem;margin-left: 15%;">
<div class="card" style="width: 80%;border-radius: 25px;">
<div class="container" style="padding: 15px 0;margin: 2px;">
    <div class="card-content" >
        <div class="profile-section" >
            <div style="text-align: center;">
            <img class="rounded-circle account-img" src="{{ re_user.profile.profile_pic.url }}" 
            alt="{{ re_user.profile.profile_pic.url }}" height="100" width="110">
            {% if user.is_authenticated and re_user.pk == user.pk %}
                <a class="btn btn-danger" href="{% url 'profile-edit' %}" style="position: absolute;border-radius: 10px;margin-left: 10rem;" >Edit Profile</a> 
            {% endif %}
                <div style="padding: 8px;color:rgb(59, 216, 255);">
                    <h2 > {{ re_user.username }}</h2>
                    <h5>{{ re_user.email }}</h5>
                    {% if  user.pk != re_user.pk and not user in re_user.profile.followers.all  %}
                        <a class="btn btn-primary" href="{% url 'follow' re_user.pk %}">Follow</a>
                    {% elif user.pk == re_user.pk %}
                    
                    {% else %}
                        <a class="btn btn-primary" href="{% url 'follow' re_user.pk %}">UnFollow</a>
                    {% endif %}
                    <hr>
            </div>
        </div>
            {% if profile %}
            <div class="container">
                <form method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ u_form|crispy }}
                    {{ p_form|crispy }}
        
                    <button class="btn btn-primary" type="submit">Update</button>
                    
                </form>

            </div>
               
                <hr>
            {% endif %}

            <div class="container">
                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item">
                      <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-followers" role="tab" aria-controls="pills-home" aria-selected="true">Followers <span class="badge badge-danger" style="color: rgb(255, 255, 255);">{{ re_user.profile.followers.count }}</span></a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-following" role="tab" aria-controls="pills-profile" aria-selected="false">Following <span class="badge badge-danger" style="color: rgb(255, 255, 255);">{{ re_user.follower_set.count }}</span></a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-bookmarks" role="tab" aria-controls="pills-contact" aria-selected="false">Bookmarks <span class="badge badge-danger" style="color: rgb(255, 255, 255);">{{ re_user.profile.bookmarks.count }}</span></a>
                    </li>
                  </ul>
                  <div class="tab-content" id="pills-tabContent" style="max-height:12rem;overflow-y: scroll;">
                    <div class="tab-pane fade show active" id="pills-followers" role="tabpanel" aria-labelledby="pills-home-tab">
                        <ul class="list-group list-group-flush" >
                            {% for follower in re_user.profile.followers.all  %}
                            <li class="list-group-item" style="display: inline-block;">
                                
                                
                                <p><img src="{{ follower.profile.profile_pic.url }}" height="50px" class="rounded-bg">
                                      <b style="font-size: 20px;"><a href="{% url 'profile' follower.pk %}?tab=follower">{{ follower.username }}</a></b></p></li>
                            {% endfor %}
                        </ul>
                        
                    </div>
                    <div class="tab-pane fade" id="pills-following" role="tabpanel" aria-labelledby="pills-profile-tab">
                        <ul class="list-group list-group-flush" >
                            {% for following in re_user.follower_set.all  %}
                            <li class="list-group-item" style="display: inline-block;">
                                
                                
                                <p><img src="{{ following.user.profile.profile_pic.url }}" height="50px" class="rounded-bg">
                                      <b style="font-size: 20px;"><a href="{% url 'profile' following.pk %}?tab=following">{{ following.user.username }}</a></b></p></li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="tab-pane fade" id="pills-bookmarks" role="tabpanel" aria-labelledby="pills-contact-tab">
                        {% for bm in re_user.profile.bookmarks.all %}
                           <a href="#"> {{ bm.title }} </a>
                        {% endfor %}
                    </div>
                  </div>
            </div>
            
            
        </div>
        
        
        
    </div>
</div>
</div>
</section>
{% endif %}
{% endblock %}